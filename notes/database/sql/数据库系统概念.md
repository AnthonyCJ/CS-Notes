# 数据库系统概念

---

# 目录

[TOC]







---



# 1. Preview





## 1.1 数据视图



### 1.1.1 数据模型

* **数据模型**（data model）：一个描述数据、数据联系、数据与一以及一致性约束的概念工具的集合。
* 数据模型的划分
  * **关系模型**（relational model）：关系模型用表的集合来表示数据和数据间的联系。表也称作**关系**。
  * **实体 - 联系模型**（entity-relationship model）：使用称作实体的基本对象的集合，以及这些对象间的联系。
  * **半结构化数据模型**（semi-structured data model）：半结构化数据模型允许在其数据定义中某些相同类型的数据项含有不同的属性集。如 JSON 和可扩展标记语言（eXtensible Markup Language, XML）被广泛地用来表示半结构化数据。
  * **基于对象的数据模型**（object-based data model）：现在对象的概念已经被很好地整合到关系数据库中。



### 1.1.2 关系数据模型

* 在关系模型中，数据以表的形式表示。表的一行表示一条信息。



### 1.1.3 数据抽象

* 数据抽象：用来对用户屏蔽复杂性，以简化用户与系统的交互。

  * 物理层（physical level）：最低层次的抽象，描述数据实际上是怎样存储的。

  * 逻辑层（logical level）：比物理层层次稍高的抽象，描述数据实际上是怎样存储的。

  * 视图层（view level）：最高层次，只描述整个数据库的某个部分。

    > 视图层抽象是为了使这些用户系统的交互更简单，系统可以为同一数据库提供多个视图。



### 1.1.4 实例和模式

* 实例（instance）：特定时刻存储在数据库中的信息的集合称作数据库的一个实例。
* 模式（schema）：数据库的总体设计。

> **实例**和**模式**的关系可类比程序**变量某时刻的值**与**变量声明**。





## 1.2 数据库语言

* 数据库定义语言（**DDL**, Data-Definition Language）

  * 域约束（domain constraint）
  * 引用完整性（referential integrity）
  * 授权（authorization）

  ~~~mysql
  CREATE TABLE department
  	(dept_name	char(20),
      building	char(15),
      budget		numeric(12,2));
  ~~~

  

* 数据库操纵语言（**DML**, Data-Manipulation Language）





## 1.3 数据库引擎

数据库系统被划分为多个模块，每个模块完成整个系统的一个功能。数据库系统的功能部件大致可分为存储管理器、**查询处理器**（query processor）部件和事务管理器部件



### 1.3.1 存储管理器

* **存储管理器**（storage manager）使数据库系统中负责在数据库中存储的低层数据域应用程序以及向系统提交的查询之间提供接口的部件。
  * 功能：存储瓜拉尼其负责与文件管理器进行交互。原始数据通过操作系统提供的文件系统存储在磁盘上。**存储管理器将各种DML语句翻译为底层文件系统命令**。因此，**存储管理器负责数据数据库中数据的存储、检索和更新**。
  * 存储管理器包括：
    * **权限及完整性管理器**（authorization and integrity manager）：检测是否满足完整性约束，并检查试图访问数据的用户的权限。
    * **事务管理器**（transaction manager）：保证计时系统发生了故障，数据库也保持在一致的（正确的）状态，并保证并发事务的执行不发生冲突。
    * **文件管理器**（file manager）：管理磁盘存储空间的分配，管理用于表示磁盘上所有存储信息的数据结构。
    * **缓冲区管理器**（buffer manager）：负责将数据从磁盘上渠道内存中，并决定那些数据应被缓冲存储在内存中。缓冲区管理器是数据库系统的一个关键部分，因为它使数据库可以处理比内存大得多的数据。
  * 作为系统物理实现的一部分，存储管理器实现了以下几种数据结构：
    * **数据文件**（data file）：存储数据库自身。
    * **数据字典**（data dictionary）：存储关于数据库结构的元素，特别是数据库模式。
    * **索引**（index）：提供对数据项的快速访问。数据库索引提供了指向特定值的数据项的指针。



### 1.3.2 查询处理器

* **查询处理器**（query processor）
  * 查询处理器包括：
    * **DDL解释器**（DDL interpreter）：解释DDL语句并将这些定义记录在数据字典中。
    * **DML编译器**（DML compliter）：将查询语言中的DML语句翻译为包括一系列查询执行引擎能理解的低级指令的执行方案。
      * **查询执行引擎**（query evaluation engine）：它执行由DML编译器产生的低级指令。



### 1.3.3 事务管理

* 以资金转账操作为例，简介**原子性**、**一致性**、**持久性**。

  * **原子性**：资金转账必须全部完成或根本不发生，这种要么都发生要么都不发生的要求称作原子性。
  * **一致性**：资金转账的执行必须保持数据库的一致性，即A和B的余额之和应该保持不变。这种正确性要求称作一致性。
  * **持久性**：党资金转账成功结束后，即使发生系统故障，账户A和账户B的月也应保持转账成功结束后的新值。这种保持的要求称作持久性。

* ==**事务**==（ transaction）

  * 概念：==事务是数据库应用中应用中完成单合一逻辑功能的操作集合==。

    > 一个事务是一个既具原子性又具一致性的单元。因此，我们要求事务不违反任何的数据库一致性约束。
    >
    > 即事务启动时数据库一致，事务成功结束时数据库也是一致的。
    >
    > 事务执行过程中，由于操作顺序问题，可能需要允许暂时不一致。

  * 事务管理器中的**并发控制管理器**（concurrency-control manager）和**恢复管理器**（recovery manager）分别用于**控制并发事务的相互影响**和**处理故障**。

